---
layout: default
title: 02. 개략적인 규모 추정
parent: 가상면접 사례로 배우는 대규모 시스템 설계 기초
---
# 02. 개략적인 규모 추정
---

## 2의 제곱수
분산 시스템에서 다루는 데이터 양은 엄청나게 커질 수 있으나 그 계산법은 기본을 크게 벗어나지 않는다.

| 2의 x 제곱 | 근사치                | 이름               | 축약형 |
| ------- | ------------------ | ---------------- | --- |
| 10      | 1천(thousand)       | 1킬로바이트(Kilobyte) | 1KB |
| 20      | 1백만(million)       | 1메가바이트(Megabyte) | 1MB |
| 30      | 10억(billion)       | 1기가바이트(Gigabyte) | 1GB |
| 40      | 1조(trillion)       | 1테라바이트(Terabyte) | 1TB |
| 50      | 1000조(quadrillion) | 1페타바이트(Petabyte) | 1PB |

## 모든 프로그래머가 알아야 하는 응답지연 값

| 연산명                                | 시간                    |
| ---------------------------------- | --------------------- |
| L1 캐시 참조                           | 0.5ns                 |
| 분기 예측 오류(branch mispredict)        | 5ns                   |
| L2 캐시 참조                           | 7ns                   |
| 뮤텍스(mutex) 락/언락                    | 100ns                 |
| 주 메모리 참조                           | 100ns                 |
| Zippy로 1 KB 압축                     | 10,000ns = 10us       |
| 1Gbps 네트워크로2KB 전송                  | 20,000ns = 20us       |
| 메모리에서 1 MB 순차적으로 read              | 250,000ns = 250us     |
| 같은 데이터 센터 내에서의 메시지 왕복 지연시간         | 500,000ns = 500us     |
| 디스크 탐색(seek)                       | 10,000,000ns = 10ms   |
| 네트워크에서 1 MB 순차적으로 read             | 10,000,000ns = 10ms   |
| 디스크에서 1 MB 순차적으로 read              | 30,000,000ns = 30ms   |
| 한 패킷의 CA(캘리포니아)로부터 네덜란드까지의 왕복 지연시간 | 150,000,000ns = 150ms |

ns= nanosecond(나노초), us = microsecond(마이크로초), ms= millisecond(밀리초)
1나노초 = 109초
1마이크로초 = 106초 = 1,000나노초
1밀리초= 103초 = 1,000µs = 1,000,000ns

이 수들을 알기 쉽게 시각화하기 위해, 한 구글 엔지니어가 개발한 도구가 있다.
![[Pasted image 20240802004450.png]]

위 수치를 통해 알수있는것
- 디스크 탐색은 가능한 피해야 한다.
- 단순한 압축 알고리즘은 빠르다.
- 데이터를 인터넷으로 전송하기 전에 가능하면 압축하라
- 데이터 센터는 보통 여러 지역에 분산되어 있고, 센터들 간에 데이터를 주고받는 데는 시간이 걸린다.


## 예제: 트위터 QPS와 저장소 요구량 추정

>QPS는 Queries Per Second(초당 쿼리 수)의 약자이다.

트위터의 실제 성능이나 요구사항과는 아무 관계가 없다.

가정
- 월간 능동 사용자는 3억명이다.
- 50%의 사용자가 트위터를 매일 사용한다.
- 평균적으로 각 사용자는 매일 2건의 트윗을 올린다.
- 미디어를 포함하는 트윗은 10% 정도다.
- 데이터는 5년간 보관된다.

추정
- 일간 능동 사용자 = 3억 x 50% = 1.5억
- QPS = 1.5억 x 2트윗  / (24시간 x 60분 x 60초 ) = 3500
- 최대 QPS = 2 x QPS = 약 7000

미디어 저장을 위한 저장소 요구량
- 평균 트윗 크기
	- tweet_id에 64바이트
	- 텍스트에 140바이트
	- 미디어에 1MB
- 미디어 저장소 요구량 : 1.5억 x 2 x 10% x 1MB = 30TB / 일
- 5년간 미디어를 보관하기 위한 저장소 요구량 : 30TB x 365 x 5 = 55PB
